{"componentChunkName":"component---src-templates-page-js","path":"/2020/手动创建macOS恢复分区","result":{"data":{"markdownRemark":{"frontmatter":{"title":"手动创建macOS恢复分区","date":"2018-11-14","path":"/2020/手动创建macOS恢复分区","author":"li","excerpt":null,"tags":null,"coverImage":null},"id":"b2592809-2718-5dea-a704-66e706da73c1","html":"<h1>手动创建macOS恢复分区</h1>\n<p>因为某些原因需要制作macOS的恢复盘，但是苹果官方的OS X 恢复磁盘助理早已不支持APFS文件系统。</p>\n<!-- more -->\n<p>打开终端，运行</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">diskutil list</code></pre></div>\n<p>会看到如下的内容：</p>\n<blockquote>\n<p>/dev/disk4 (synthesized):</p>\n<h1>:                       TYPE NAME                    SIZE       IDENTIFIER</h1>\n<p>   0:      APFS Container Scheme -                      +42.7 GB    disk4\nPhysical Store disk2s2\n1:                APFS Volume li                      26.3 GB    disk4s1\n2:                APFS Volume Preboot                 44.5 MB    disk4s2\n<font color='red'> 3:                APFS Volume Recovery                512.4 MB   disk4s3</font>\n4:                APFS Volume VM                      20.5 KB    disk4s4</p>\n</blockquote>\n<p>找到Recovery分区，然后挂载</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">diskutil <span class=\"token function\">mount</span> disk4s3</code></pre></div>\n<p>使用磁盘工具将需要制作的恢复分区格式化为HFS+ J格式</p>\n<p>创建目录（xxx为你需要创建的引导分区的挂载点）</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">mkdir</span> -p /Volumes/xxxxx/System/Library/CoreServices</code></pre></div>\n<p>挂载Recovery分区下BaseSystem.dmg</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">hdiutil attach /Volumes/Recovery/5A3C3475-7E2B-39A9-8C39-5BBEE5C156EC/BaseSystem.dmg</code></pre></div>\n<p>复制引导文件：</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">cp</span> /Volumes/OS<span class=\"token punctuation\">\\</span> X<span class=\"token punctuation\">\\</span> Base<span class=\"token punctuation\">\\</span> System/System/Library/CoreServices/boot* System/Library/CoreServices\n<span class=\"token function\">cp</span> /Volumes/OS<span class=\"token punctuation\">\\</span> X<span class=\"token punctuation\">\\</span> Base<span class=\"token punctuation\">\\</span> System/System/Library/CoreServices/BridgeVersion* System/Library/CoreServices\n<span class=\"token function\">cp</span> /Volumes/OS<span class=\"token punctuation\">\\</span> X<span class=\"token punctuation\">\\</span> Base<span class=\"token punctuation\">\\</span> System/System/Library/CoreServices/PlatformSupport.plist System/Library/CoreServices\n<span class=\"token function\">cp</span> /Volumes/OS<span class=\"token punctuation\">\\</span> X<span class=\"token punctuation\">\\</span> Base<span class=\"token punctuation\">\\</span> System/System/Library/CoreServices/SystemVersion.plist System/Library/CoreServices</code></pre></div>\n<p>创建引导配置文件，使得从BaseSystem.dmg进行第二阶段引导</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">mkdir</span> -p Library/Preferences/SystemConfiguration/\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"&lt;?xml version=1.0 encoding=UTF-8?>\n&lt;plist version=1.0>\n&lt;dict>\n&lt;key>Kernel Flags&lt;/key>\n&lt;string>root-dmg=file:///BaseSystem.dmg&lt;/string>\n&lt;/dict>\n&lt;/plist>\"</span> <span class=\"token operator\">></span> Library/Preferences/SystemConfiguration/com.apple.Boot.plist </code></pre></div>\n<p>复制内核缓存（解决VMware下引导失败）</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cp -r /Volumes/OS\\ X\\ Base\\ System/System/Library/PrelinkedKernels  System/Library/</code></pre></div>\n<p>选择启动磁盘即可（分区格式为EFI也可以识别的）</p>\n<p>====== 以前内容 ======</p>\n<p><strong>（以下方法在部分设备上无法引导）</strong></p>\n<p>在Finder（访达）中找到恢复分区的BaseSystem.dmg(第二阶段启动使用)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/Volumes/Recovery/5A3C3475-7E2B-39A9-8C39-5BBEE5C156EC/BaseSystem.dmg</code></pre></div>\n<p>打开磁盘工具，选择一个分区，使用恢复</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc1df5774e78c916e5d95d7d470ce829/8e749/macOS-rev.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyElEQVQ4y21TTU8TQRjei568iNGTX4mJCbT7vdud7W637XZ1t7utXQq0tJTSlqSlLalAJEFsEGiIHDRcPHv1B3jwCtw8e/Lf+OwuIKhPnkzemXk/nnlnhprKfXmQ/8rOfZ7ODB6SwZNkwKfaOsbHKth/lBw9E32enqZJWrbLjdpiu9ORZZnneer2i++37LPn9pFGhNcbW8Ph+s7OW9u2WZaFR+I6ZCkhCXGahqkoShBspDNesYSREPImxObm5ihEPp+XJAnryiWIqgohsI6RQvZczkoZBiFqsVgsl8soWygUarVaLpdTVTV5DZqmiaIIUWIICtUxgRL49fv9Xq83Ho9XV1exHpS6CTWsjK3gELJMIQE0YETiUqnkum6lUoGRSqWS/wNSpNNpLQRlWVar1YJC1Nne3sZRB4MB4pERrupNwCeTyXieBzsINgzDcRxd15Hy5ORkMpn4vo8VqFL+AXygESOiII3CkmmaKAIDB242mxzH/RUZHTiysYWaeoigYfCONpAPerAthbgyoouJkgKolApBRffGC4KmG74/68+WXa+Im7cdN+8WQCfv+eX56mK9udLGFP2FBpQOzhy2XmCZuCzFPPdlo1FZqhZHw/Zwrdlantva6Pa7jXq1COPocKcyh16wlm2jLGQiWOR4RuSzC9bu2tKkPb9vZvZy6TFomXtmegxa2b2s8c40drPZg4a90XSdBJTjzHhqHB8ThZLsfOt9+tX98PN+4XTKPf9D7/yuewbjnnt6p/BjJvVxQaB5okJ8IJvjBZFhlgk57HT3VzormlaT5SVFwVhXEjdIlCq6w3EsH+CiYfgrRNffTw6Ojo+X8eV6vf5o5L4qCYkEfsYVZVWleYHB2w6jLoIZhmEZRsXjJaosycFzFUA0kgUZmokMDt+ApnG3wvVgaKBZdjoWA2M0DcZDYhGcicfjDBPZ7GUk8BuDSRffSGuBlgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/dc1df5774e78c916e5d95d7d470ce829/8e749/macOS-rev.png\"\n        srcset=\"/static/dc1df5774e78c916e5d95d7d470ce829/56d15/macOS-rev.png 200w,\n/static/dc1df5774e78c916e5d95d7d470ce829/8e749/macOS-rev.png 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>选择映像，然后选择刚刚找到的BaseSystem.dmg</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a79d3a611521649c29bcc56d80d14a9a/45cbc/macOS-rev2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 89.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACx0lEQVQ4y2VTS08aURSe/1Ckynt4MzMwM8wMw/CGAbFYrEBsKZiyQGZoYk13TVz0lW77P7rozoVJE9OkNiZ117iXuDQmjYmxXdqPuRVt+4Vc7rnnfud859wzlCxJfCIhCoIsy9lsVtM0VVXTFjIWJEmCK5lMyrcgWaBSqrqy2qroerlcrlQqhA8mNvl8XhCE5DVwWxTFmYk9VavXP+zsbr98bRrGaDTq9Xrr6+uGYQwGg06n07SwtLTUarUKhQLHcSQKQpdKJSqbyz/s9u+vrFb0Wqms69Ua8uM20iJ/7hrFYhGKwFQUBXXBixOqUsxIfEyVE6rILLceGObQHG0ApmmOx+Nut0vKgyJogfnYAkxooYrNjVzzafqeodRH4fzQp3RjDBcKhcLhcDAYjEQiuq5DCMMwHo+HHMLr9/unNWcahlgzo7knQa0/L/Tu8mv+QMjlcuLqwsJCIpE4Pj6+urr6ur/P87zdbvd6vcQFk8qmJZ4NsRFa4EJs2ON32wOBgNvtxiWHw4Fun56e/jg/v7i8PDg4iEajLpfL5/PBNSUXimVFSaVUTU1rDBv3+mgIm5GhbXJy8nH3087nLxc/f600m7a5OZqm/5DR0ng8jh2qQiVwzDJDG3r77fBw++27F6/efD866rTbd2y2GzKeAeEFC3gJtAQhZmT0eTKZQPDe3t7Z2Rk6bLtNxouRiQMTMwAmyYyuYIXZ7/e3nm1tbm4Oh0OWZVEzqWhKxovjD12FbHQCjhmZAHmwEg45uSGjPbQFJMEp+P+QMZUYe+TAhMFLKnI6nVPyLB7R+T+ZsYBpIRWRTA6HUxDEKdl9DaINlxAYJrSBU6/X8RlgrVarjUYjndbUlOKYt4WDNBWLxaK3ABNdAYeYyIku4iRuAR96LqtxyQyjLjOyTnFc/O8fwY3JTsExDItA1drio7U2l1mVu+9ji89/A0wg9Y/Q/daFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/a79d3a611521649c29bcc56d80d14a9a/45cbc/macOS-rev2.png\"\n        srcset=\"/static/a79d3a611521649c29bcc56d80d14a9a/56d15/macOS-rev2.png 200w,\n/static/a79d3a611521649c29bcc56d80d14a9a/d9f49/macOS-rev2.png 400w,\n/static/a79d3a611521649c29bcc56d80d14a9a/45cbc/macOS-rev2.png 643w\"\n        sizes=\"(max-width: 643px) 100vw, 643px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>引导时候选择这一分区即可</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9e71f83d54745b425a2fff2f20db42f/46b67/macOs-rev3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz4WS22rCQBCG9yWkVk0ENVSjIQfPiSYxBjexKqhtwSIUe9GLPkOv+uJ/M0Mj0uPFx+7Mzv4zO7Ni7Q8QRx7S5S2klFitVphOp+j3+xgMBuj1euzfbDbsyyF/kiTsT9P0jFjMAixTiTiOkXwKjkYjmKaJbrcLx3HYHo/HvL+EEtIZrcPhkFcxyaqRMkGSqUdRhPk8Qi8TsiwTequFTqcDXdeZdrt95tKfQz6hKgraHQP3h0cUCgUUiyUEc4nD0zMqShWqqp5RsthLvp7V63WIRqMBwzD4eVVVgW72cffyhofXdzhujNL1FQdXKpU/KZfLqNVqEEZWJglSz+gpzeZNVrrBaFoDlFDTtH+huFbWIuGHEfb7PbbbLfcwCAL4/pShJtu2/W0YBL2Ipn88HnE6nbDb7bBYLCBkOITneZhMJjxJEnFdly9YlsWXSfQn6OvQdPNJky3WoQ3PHWM2m3F19AfDMOTAvLrfBAlKmkP2BzNbH2+rbdbtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"img\"\n        src=\"/static/b9e71f83d54745b425a2fff2f20db42f/46b67/macOs-rev3.png\"\n        srcset=\"/static/b9e71f83d54745b425a2fff2f20db42f/56d15/macOs-rev3.png 200w,\n/static/b9e71f83d54745b425a2fff2f20db42f/d9f49/macOs-rev3.png 400w,\n/static/b9e71f83d54745b425a2fff2f20db42f/46b67/macOs-rev3.png 662w\"\n        sizes=\"(max-width: 662px) 100vw, 662px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","excerpt":"手动创建macOS恢复分区 因为某些原因需要制作macOS的恢复盘，但是苹果官方的OS X 恢复磁盘助理早已不支持APFS文件系统。 打开终端，运行 会看到如下的内容： /dev/disk4 (synthesized): :                       TYPE…"}},"pageContext":{"type":"posts","next":null,"previous":{"frontmatter":{"path":"/2020/测试","title":"测试","tags":null},"fileAbsolutePath":"/home/runner/work/new-blog/new-blog/src/posts/2020/example2.md"}}},"staticQueryHashes":["1425477374","3128451518"]}